<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Bottlefish's Notebook" name="description"/><link href="https://note.bottlefish.cn/AI/TSFM/Kronos/" rel="canonical"/><link href="../" rel="prev"/><link href="../../../assets/images/favicon.png" rel="icon"/><meta content="mkdocs-1.6.1, mkdocs-material-9.6.18" name="generator"/><title>Kronos - Bottlefish's Notebook</title><link href="../../../assets/stylesheets/main.7e37652d.min.css" rel="stylesheet"/><link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1%207.775V2.75C1%201.784%201.784%201%202.75%201h5.025c.464%200%20.91.184%201.238.513l6.25%206.25a1.75%201.75%200%200%201%200%202.474l-5.026%205.026a1.75%201.75%200%200%201-2.474%200l-6.25-6.25A1.75%201.75%200%200%201%201%207.775m1.5%200c0%20.066.026.13.073.177l6.25%206.25a.25.25%200%200%200%20.354%200l5.025-5.025a.25.25%200%200%200%200-.354l-6.25-6.25a.25.25%200%200%200-.177-.073H2.75a.25.25%200%200%200-.25.25ZM6%205a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.5%201.75v11.5c0%20.138.112.25.25.25h3.17a.75.75%200%200%201%200%201.5H2.75A1.75%201.75%200%200%201%201%2013.25V1.75C1%20.784%201.784%200%202.75%200h8.5C12.216%200%2013%20.784%2013%201.75v7.736a.75.75%200%200%201-1.5%200V1.75a.25.25%200%200%200-.25-.25h-8.5a.25.25%200%200%200-.25.25m13.274%209.537zl-4.557%204.45a.75.75%200%200%201-1.055-.008l-1.943-1.95a.75.75%200%200%201%201.062-1.058l1.419%201.425%204.026-3.932a.75.75%200%201%201%201.048%201.074M4.75%204h4.5a.75.75%200%200%201%200%201.5h-4.5a.75.75%200%200%201%200-1.5M4%207.75A.75.75%200%200%201%204.75%207h2a.75.75%200%200%201%200%201.5h-2A.75.75%200%200%201%204%207.75%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.5%207.75A.75.75%200%200%201%207.25%207h1a.75.75%200%200%201%20.75.75v2.75h.25a.75.75%200%200%201%200%201.5h-2a.75.75%200%200%201%200-1.5h.25v-2h-.25a.75.75%200%200%201-.75-.75M8%206a1%201%200%201%201%200-2%201%201%200%200%201%200%202%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M3.499.75a.75.75%200%200%201%201.5%200v.996C5.9%202.903%206.793%203.65%207.662%204.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873%2010.794-.045%2012.622.26%2014.408.558%2016%201.94%2016%204.25c0%201.278-.954%202.575-2.44%202.734l.146.508.065.22c.203.701.412%201.455.476%202.226.142%201.707-.4%203.03-1.487%203.898C11.714%2014.671%2010.27%2015%208.75%2015h-6a.75.75%200%200%201%200-1.5h1.376a4.5%204.5%200%200%201-.563-1.191%203.84%203.84%200%200%201-.05-2.063%204.65%204.65%200%200%201-2.025-.293.75.75%200%200%201%20.525-1.406c1.357.507%202.376-.006%202.698-.318l.009-.01a.747.747%200%200%201%201.06%200%20.75.75%200%200%201-.012%201.074c-.912.92-.992%201.835-.768%202.586.221.74.745%201.337%201.196%201.621H8.75c1.343%200%202.398-.296%203.074-.836.635-.507%201.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4%202.4%200%200%201-.507-.441%203.1%203.1%200%200%201-.633-1.248.75.75%200%200%201%201.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738%200%201.25-.615%201.25-1.25%200-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706%201.345-.46.92-.27%201.774.019%203.062l.042.19.01.05c.348.443.666.949.94%201.553a.75.75%200%201%201-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7%205.527c-.814-.68-1.75-1.462-2.692-2.619a3.7%203.7%200%200%200-1.023.88c-.406.495-.663%201.036-.722%201.508.116.122.306.21.591.239.388.038.797-.06%201.032-.19a.75.75%200%200%201%20.728%201.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75%205.677V5.5c0-.984.48-1.94%201.077-2.664.46-.559%201.05-1.055%201.673-1.353z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M13.78%204.22a.75.75%200%200%201%200%201.06l-7.25%207.25a.75.75%200%200%201-1.06%200L2.22%209.28a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018L6%2010.94l6.72-6.72a.75.75%200%200%201%201.06%200%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.92%206.085h.001a.749.749%200%201%201-1.342-.67c.169-.339.436-.701.849-.977C6.845%204.16%207.369%204%208%204a2.76%202.76%200%200%201%201.637.525c.503.377.863.965.863%201.725%200%20.448-.115.83-.329%201.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6%206%200%200%200-.26.16%201%201%200%200%200-.276.245.75.75%200%200%201-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1%201%200%200%200%20.277-.245C8.96%206.514%209%206.427%209%206.25a.61.61%200%200%200-.262-.525A1.27%201.27%200%200%200%208%205.5c-.369%200-.595.09-.74.187a1%201%200%200%200-.34.398M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M6.457%201.047c.659-1.234%202.427-1.234%203.086%200l6.082%2011.378A1.75%201.75%200%200%201%2014.082%2015H1.918a1.75%201.75%200%200%201-1.543-2.575Zm1.763.707a.25.25%200%200%200-.44%200L1.698%2013.132a.25.25%200%200%200%20.22.368h12.164a.25.25%200%200%200%20.22-.368Zm.53%203.996v2.5a.75.75%200%200%201-1.5%200v-2.5a.75.75%200%200%201%201.5%200M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.344%202.343za8%208%200%200%201%2011.314%2011.314A8.002%208.002%200%200%201%20.234%2010.089a8%208%200%200%201%202.11-7.746m1.06%2010.253a6.5%206.5%200%201%200%209.108-9.275%206.5%206.5%200%200%200-9.108%209.275M6.03%204.97%208%206.94l1.97-1.97a.749.749%200%200%201%201.275.326.75.75%200%200%201-.215.734L9.06%208l1.97%201.97a.749.749%200%200%201-.326%201.275.75.75%200%200%201-.734-.215L8%209.06l-1.97%201.97a.749.749%200%200%201-1.275-.326.75.75%200%200%201%20.215-.734L6.94%208%204.97%206.03a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M9.504.43a1.516%201.516%200%200%201%202.437%201.713L10.415%205.5h2.123c1.57%200%202.346%201.909%201.22%203.004l-7.34%207.142a1.25%201.25%200%200%201-.871.354h-.302a1.25%201.25%200%200%201-1.157-1.723L5.633%2010.5H3.462c-1.57%200-2.346-1.909-1.22-3.004zm1.047%201.074L3.286%208.571A.25.25%200%200%200%203.462%209H6.75a.75.75%200%200%201%20.694%201.034l-1.713%204.188%206.982-6.793A.25.25%200%200%200%2012.538%207H9.25a.75.75%200%200%201-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005%200-.009.004%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M4.72.22a.75.75%200%200%201%201.06%200l1%20.999a3.5%203.5%200%200%201%202.441%200l.999-1a.748.748%200%200%201%201.265.332.75.75%200%200%201-.205.729l-.775.776c.616.63.995%201.493.995%202.444v.327q0%20.15-.025.292c.408.14.764.392%201.029.722l1.968-.787a.75.75%200%200%201%20.556%201.392L13%207.258V9h2.25a.75.75%200%200%201%200%201.5H13v.5q-.002.615-.141%201.186l2.17.868a.75.75%200%200%201-.557%201.392l-2.184-.873A5%205%200%200%201%208%2016a5%205%200%200%201-4.288-2.427l-2.183.873a.75.75%200%200%201-.558-1.392l2.17-.868A5%205%200%200%201%203%2011v-.5H.75a.75.75%200%200%201%200-1.5H3V7.258L.971%206.446a.75.75%200%200%201%20.558-1.392l1.967.787c.265-.33.62-.583%201.03-.722a1.7%201.7%200%200%201-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72%201.28a.75.75%200%200%201%200-1.06m.53%206.28a.75.75%200%200%200-.75.75V11a3.5%203.5%200%201%200%207%200V7.25a.75.75%200%200%200-.75-.75ZM6.173%205h3.654A.17.17%200%200%200%2010%204.827V4.5a2%202%200%201%200-4%200v.327c0%20.096.077.173.173.173%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5%205.782V2.5h-.25a.75.75%200%200%201%200-1.5h6.5a.75.75%200%200%201%200%201.5H11v3.282l3.666%205.76C15.619%2013.04%2014.543%2015%2012.767%2015H3.233c-1.776%200-2.852-1.96-1.899-3.458Zm-2.4%206.565a.75.75%200%200%200%20.633%201.153h9.534a.75.75%200%200%200%20.633-1.153L12.225%2010.5h-8.45ZM9.5%202.5h-3V6c0%20.143-.04.283-.117.403L4.73%209h6.54L9.617%206.403A.75.75%200%200%201%209.5%206Z%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1.75%202.5h10.5a.75.75%200%200%201%200%201.5H1.75a.75.75%200%200%201%200-1.5m4%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5m0%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5M2.5%207.75v6a.75.75%200%200%201-1.5%200v-6a.75.75%200%200%201%201.5%200%22/%3E%3C/svg%3E');}</style><style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M22%2012a10%2010%200%200%201-10%2010A10%2010%200%200%201%202%2012%2010%2010%200%200%201%2012%202a10%2010%200%200%201%2010%2010m-12%206%206-6-6-6-1.4%201.4%204.6%204.6-4.6%204.6z%22/%3E%3C/svg%3E');}</style><link href="../../../css/heti.css" rel="stylesheet"/><link href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" rel="stylesheet"/><link href="../../../css/custom.css" rel="stylesheet"/><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script> <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head> <body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr"> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#kronos-a-foundation-model-for-the-language-of-financial-markets"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="Bottlefish's Notebook" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="Bottlefish's Notebook"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 4v6l-2-2-2 2V4H9v16h10V4zM3 7V5h2V4a2 2 0 0 1 2-2h12c1.05 0 2 .95 2 2v16c0 1.05-.95 2-2 2H7c-1.05 0-2-.95-2-2v-1H3v-2h2v-4H3v-2h2V7zm2-2v2h2V5zm0 14h2v-2H5zm0-6h2v-2H5z"></path></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> Bottlefish's Notebook </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> Kronos </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to system preference"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg> </label> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="Share"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg> </a> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0"> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a class="md-source" data-md-component="source" href="https://github.com/BottleFish326/notes/" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg> </div> <div class="md-source__repository"> BottleFish's Notes </div> </a> </div> </nav> <nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"> <div class="md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../.."> Home </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../../mathematics/"> Mathematics </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../../boolean/"> Index </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a class="md-tabs__link" href="../../"> AI </a> </li> </ul> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="Bottlefish's Notebook" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="Bottlefish's Notebook"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 4v6l-2-2-2 2V4H9v16h10V4zM3 7V5h2V4a2 2 0 0 1 2-2h12c1.05 0 2 .95 2 2v16c0 1.05-.95 2-2 2H7c-1.05 0-2-.95-2-2v-1H3v-2h2v-4H3v-2h2V7zm2-2v2h2V5zm0 14h2v-2H5zm0-6h2v-2H5z"></path></svg> </a> Bottlefish's Notebook </label> <div class="md-nav__source"> <a class="md-source" data-md-component="source" href="https://github.com/BottleFish326/notes/" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg> </div> <div class="md-source__repository"> BottleFish's Notes </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../.."> <span class="md-ellipsis"> Home </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../mathematics/"> <span class="md-ellipsis"> Mathematics </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../boolean/"> <span class="md-ellipsis"> Index </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/> <div class="md-nav__link md-nav__container"> <a class="md-nav__link" href="../../"> <span class="md-ellipsis"> AI </span> </a> <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex=""> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> AI </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_4_2" type="checkbox"/> <div class="md-nav__link md-nav__container"> <a class="md-nav__link" href="../"> <span class="md-ellipsis"> TSFM </span> </a> <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex=""> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded="true" aria-labelledby="__nav_4_2_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_4_2"> <span class="md-nav__icon md-icon"></span> TSFM </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_4_2_2" type="checkbox"/> <div class="md-nav__link md-nav__container"> <a class="md-nav__link md-nav__link--active" href="./"> <span class="md-ellipsis"> Kronos </span> </a> </div> <nav aria-expanded="true" aria-labelledby="__nav_4_2_2_label" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_4_2_2"> <span class="md-nav__icon md-icon"></span> Kronos </label> <ul class="md-nav__list" data-md-scrollfix=""> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="On this page" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> On this page </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#1-introduction"> <span class="md-ellipsis"> 1. Introduction </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#2-motivation"> <span class="md-ellipsis"> 2. Motivation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#3-preliminary"> <span class="md-ellipsis"> 3. Preliminary </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#4-methodology"> <span class="md-ellipsis"> 4. Methodology </span> </a> <nav aria-label="4. Methodology" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#41-k-line-tokenization"> <span class="md-ellipsis"> 4.1 K-line Tokenization </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#42-hierarchical-autoregressive-modeling"> <span class="md-ellipsis"> 4.2 Hierarchical Autoregressive Modeling </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#5-results-and-conclusion"> <span class="md-ellipsis"> 5. Results and Conclusion </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h1 id="kronos-a-foundation-model-for-the-language-of-financial-markets">Kronos: A Foundation Model for the Language of Financial Markets<a class="headerlink" href="#kronos-a-foundation-model-for-the-language-of-financial-markets" title="Permanent link">¶</a></h1> <div class="admonition quote"> <p class="admonition-title">Reference Paper</p> <p><strong><a href="https://arxiv.org/abs/2508.02739">Kronos: A Foundation Model for the Language of Financial Markets</a></strong></p> <p><strong>Author</strong>: Department of Automation Tsinghua University</p> <p><strong>Date</strong>: 2 Aug 2025</p> </div> <div class="admonition abstract"> <p class="admonition-title">Abstract</p> <p>The success of large-scale pre-training paradigm, exemplified by Large Language Models (LLMs), has inspired the development of Time Series Foundation Models (TSFMs). However, their application to financial candlestick (K-line) data remains limited, often underperforming non-pre-trained architectures. Moreover, existing TSFMs often overlook crucial downstream tasks such as volatility prediction and synthetic data generation. To address these limitations, we propose <strong>Kronos, a unified, scalable pre-training framework tailored to financial K-line modeling</strong>. Kronos introduces a specialized tokenizer that discretizes continuous market information into token sequences, preserving both price dynamics and trade activity patterns. We pre-train Kronos using an autoregressive objective on a massive, multi-market corpus of over 12 billion K-line records from 45 global exchanges, enabling it to learn nuanced temporal and cross-asset representations. Kronos excels in a zero-shot setting across a diverse set of financial tasks. On benchmark datasets, Kronos boosts price series forecasting RankIC by 93% over the leading TSFM and 87% over the best non-pre-trained baseline. It also achieves a 9% lower MAE in volatility forecasting and a 22% improvement in generative fidelity for synthetic K-line sequences. These results establish Kronos as a robust, versatile foundation model for end-to-end financial time series analysis. Our pre-trained model is publicly available at https://github.com/shiyu-coder/Kronos.</p> </div> <h2 id="1-introduction">1. Introduction<a class="headerlink" href="#1-introduction" title="Permanent link">¶</a></h2> <p>Financial markets is a critical and challenging application area for TSFMs, given their inherent data richness, high-frequency observations, and complex, non-stationary temporal dynamics. At the core of this domain are K-line sequences, multivariate time series derived from candle-stick charts that record <strong>O</strong>pen, <strong>H</strong>igh, <strong>L</strong>ow, and <strong>C</strong>lose prices, along with trading <strong>V</strong>olume and <strong>A</strong>mount(Turnover) over fixed intervals(<strong>OHLCVA</strong>). These sequences constitute a highly compact, information-dense "language" through which market participants interpret prices movements, volatility regimes, liquidity shifts, and colletive sentment.</p> <h2 id="2-motivation">2. Motivation<a class="headerlink" href="#2-motivation" title="Permanent link">¶</a></h2> <p>Despite the promise of TSFMs. Old application to finance faces significant hurdles.</p> <ol> <li>Unique statistical properties of K-line data<ul> <li>Low signal-to-noise ratio, strong non-stationarity, and complex interdependencies among OHLCVA features.</li> <li>These properties are poorly aligned with the inductive biases of general-purpose TSFMs.</li> </ul> </li> <li>Underserved financial domain in pre-training<ul> <li>Most TSFMs are trained on broad, multi-domain corpora where financial data accounts for only a tiny fraction.</li> <li>As a result, financial-specific dynamics are overlooked or averaged out.</li> </ul> </li> <li>Task gaps<ul> <li>Critical finance-specific tasks such as volatility prediction, synthetic data generation, and risk management remain largely unaddressed by existing TSFMs.</li> </ul> </li> </ol> <p>Empirical evidence shows that general-purpose TSFMs often underperform even non-pre-trained, specialized models (like iTransformer) on financial tasks. This reveals a gap: the field lacks a foundation model built specifically for financial time series.</p> <h2 id="3-preliminary">3. Preliminary<a class="headerlink" href="#3-preliminary" title="Permanent link">¶</a></h2> <p>Let <span class="arithmatex">\(D\)</span>-dimensional vector <span class="arithmatex">\(x_t \in \mathbb{R}^D\)</span> denote the K-line observation at discrete time <span class="arithmatex">\(t\)</span>, comprising <span class="arithmatex">\(D\)</span> key financial indicators. In this work, the dimension was fixed <span class="arithmatex">\(D=6\)</span> to represent OHLCVA attributes. Given a historical sequence <span class="arithmatex">\(x_{1:T}=(x_1,x_2,...,x_T)\)</span>, our objective is to predict the following <span class="arithmatex">\(H\)</span> observations <span class="arithmatex">\(\hat{x}_{T+1:T+H}=(\hat{x}_{T+1}, \hat{x}_{T+2},...,\hat{x}_{T+H})\)</span>.</p> <p>Rather than operating on raw continuous inputs, Kronos first quantizes each multivariate observation <span class="arithmatex">\(x_t\)</span> into a discrete token <span class="arithmatex">\(b_t\)</span> via a learnable codebook <span class="arithmatex">\(\mathcal{C}\)</span>. Consequently, the original sequence <span class="arithmatex">\(x_{1:T}=(x_1,x_2,...,x_T)\)</span> is mapped to <span class="arithmatex">\(b_{1:T}=(b_1,...,b_T)\)</span>. The forecasting task then reduces to an autoregressive token-sequence modeling problem:</p> <div class="arithmatex">\[ p(\mathbf{b}_{T+1:T+H}|\mathbf{b}_{1:T}) = \sum_{h=1}^{H} p(b_{T+h}|\mathbf{b}_{1:T+h-1}) \]</div> <h2 id="4-methodology">4. Methodology<a class="headerlink" href="#4-methodology" title="Permanent link">¶</a></h2> <p>Kronos implements this via a two-phase framework: <strong>(1) K-line Tokenization</strong> and <strong>(2) Autoregressive Pre-training</strong></p> <h3 id="41-k-line-tokenization">4.1 K-line Tokenization<a class="headerlink" href="#41-k-line-tokenization" title="Permanent link">¶</a></h3> <figure> <a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="figures/tokenizer.png"><img _="," alt="tokenization" loading="lazy" src="figures/tokenizer.png" width="50%"/></a> </figure> <p>The tokenization is achieved using a Transformer-based autoencoder composed of an encoder <span class="arithmatex">\(E_{\text{enc}}\)</span>, a quantizer <span class="arithmatex">\(Q\)</span>, and a decoder <span class="arithmatex">\(E_{\text{dec}}\)</span>.</p> <p>Kronos adapt Binary Spherical Quantization(BSQ) for this task. BSQ quantizes a continuous latent vector <span class="arithmatex">\(\xi_t\)</span> into a <span class="arithmatex">\(k\)</span>-bit binary code <span class="arithmatex">\(b_t \in \{-1,1\}^k\)</span> by projecting it onto a set of learnable hyperplanes.</p> <h4 id="411-introduction-to-bsq">4.1.1 Introduction to BSQ<a class="headerlink" href="#411-introduction-to-bsq" title="Permanent link">¶</a></h4> <div class="admonition quote"> <p class="admonition-title">Related Paper</p> <p><strong><a href="https://arxiv.org/abs/2406.07548">Image and Video Tokenization with Binary Spherical Quantization</a></strong></p> </div> <figure> <a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="figures/BSQ.png"><img _="," alt="BSQ" loading="lazy" src="figures/BSQ.png" width="100%"/></a> </figure> <p>Binary Spherical Quantization (BSQ) optimizes over an implicit codebook <span class="arithmatex">\(\textbf{C}_{BSQ}=\{-\frac{1}{\sqrt{L}}, \frac{1}{\sqrt{L}}\}^L\)</span>, a hypercube projected onto a unit sphere. Each corner <span class="arithmatex">\(\textbf{c}_k \in \textbf{C}_{BSQ}\)</span> of a hypercube corresponds to a unique token <span class="arithmatex">\(k\)</span>. The quantizer works as follows: it projects some high-dimensional latent embedding <span class="arithmatex">\(\textbf{z}\)</span> to a lower-dimensional unit hypersphere <span class="arithmatex">\(\textbf{u}\)</span>, applies binary quantization per axis <span class="arithmatex">\(\hat{\textbf{u}}=sign(\textbf{u})\)</span> and back-projects to the quantized vector in the original latent space <span class="arithmatex">\(\hat{\textbf{x}}\)</span>. Specifically, we start with an encoded visual input <span class="arithmatex">\(\textbf{z}=\mathcal{E}(\textbf{x}) \in \mathbb{R}^d\)</span>. We first linearly project the latent embedding to <span class="arithmatex">\(L\)</span> dimensions <span class="arithmatex">\(\textbf{v} = Linear(\textbf{z}) \in \mathbb{R}^L\)</span>, where <span class="arithmatex">\(L \ll d\)</span>. Next, we obtain project <span class="arithmatex">\(\textbf{v}\)</span> onto the unit sphere <span class="arithmatex">\(\textbf{u}=\frac{\textbf{v}}{|\textbf{v}|}\)</span> and perform binary quantization to each dimension of <span class="arithmatex">\(u\)</span> independently <span class="arithmatex">\(\hat{\textbf{u}}=\frac{1}{\sqrt{L}} sign(\textbf{\textbf{u}})\)</span>, where <span class="arithmatex">\(sign(x)\)</span> is the sign function. To keep outputs on the unit sphere, we map <span class="arithmatex">\(sign(0) \rightarrow 1\)</span>. We use a Straight-Through Estimator (STE) make the operator differentiable, <span class="arithmatex">\(sign_{STE}(x) = sg(sign(x)−x) + x\)</span>, where <span class="arithmatex">\(sg(·)\)</span> denotes the stop-gradient operation. Finally, we back-project the quantized <span class="arithmatex">\(\hat{\textbf{u}}\)</span> to the <span class="arithmatex">\(d\)</span>-dimensional space <span class="arithmatex">\(\hat{\textbf{z}} = Linear(\hat{\textbf{u}}) \in \mathbb{R}^d\)</span>.</p> <h4 id="412-effectiveness-of-bsq">4.1.2 Effectiveness of BSQ<a class="headerlink" href="#412-effectiveness-of-bsq" title="Permanent link">¶</a></h4> <p>The effectiveness of BSQ tokenizer can be analyzed from two key perspectivs: its inherent noise suppression and its ability to create a structured, discrete state space suitable for sequence modeling.</p> <h5 id="noise-suppression-and-stability">Noise Suppression And Stability<a class="headerlink" href="#noise-suppression-and-stability" title="Permanent link">¶</a></h5> <p>BSQ's projection of embeddings onto a unit sphere prior to binarization guarantees that the expected distortion is strictly upper-bounded:</p> <div class="arithmatex">\[ \mathbb{E}_u\|u-\hat{u}\| &lt; \sqrt{2-\frac{2}{\sqrt{L}}} &lt; \sqrt{2} \]</div> <p>This bound tightens as the codebook dimension <span class="arithmatex">\(L\)</span> increases. In contrast, simple methods like sign-based quantization without normalization(e.g., LFQ) lack such a guarantee, leaving them vulnerable to arbitarily large errors from outlier inputs.</p> <h5 id="learning-in-a-compact-and-discrete-state-space">Learning in a Compact and Discrete State Space<a class="headerlink" href="#learning-in-a-compact-and-discrete-state-space" title="Permanent link">¶</a></h5> <p>High-frequency financial data exists in a high-dimensional, continuous state space. This tokenizer maps these in a finite, discrete vocabulary of tokens. This discretization serves as a powerful form of regularization with two main benefits.</p> <p><strong>Inproved Sample Efficiency and Generalization</strong>: Instead of learning a complex function over a continuous space, a downstream model like a Transformer learns to predict transitions and patterns among a finite set of abstract states(tokens). This simplifies the learning tasks and also allows the model to learn robust patterns from fewer examples, which is particularly critical for modeling rare market phenomena.</p> <p><strong>Reduced Overfitting</strong>: The quantization process inherently discards fine-grained, potentially noisy variations within each quantization cells. This prevents the model from fitting to spurious artifacts in the tarining data.</p> <h5 id="hyperspherical-geometry-for-tail-sensitivity">Hyperspherical geometry for tail sensitivity<a class="headerlink" href="#hyperspherical-geometry-for-tail-sensitivity" title="Permanent link">¶</a></h5> <p>In financial contexts, market returns and price changes often exhibit heavy tails(or fat tails). The heavy-tail distribution of price changes is one of the key sources of trading profits in quantitative investment and cannot be ignored.</p> <p>Unlike standard vector-quantization on the Euclidean sphere, BSQ's binary encoding preserves angular information very efficiently, making it more sensitive to fat-tail data that manifest as sharp directional changes in feature space. This aligns well how microstructure events often appear as abrupt shifts in the "direction" of the joint price-volume vector.</p> <h4 id="413-subtoken-factorization">4.1.3 Subtoken Factorization<a class="headerlink" href="#413-subtoken-factorization" title="Permanent link">¶</a></h4> <p>While a large number of bits <span class="arithmatex">\(k\)</span> (e.g., <span class="arithmatex">\(k=20\)</span>) is desirable for capturing rich financial patterns, it results in an exponentially large vocabulary of size <span class="arithmatex">\(2^k\)</span>. To mitigate this, we use the subtoken factorization and factorize the <span class="arithmatex">\(k\)</span>-bit code into <span class="arithmatex">\(n\)</span> subspaces. Motivated by the trade-off between parameter savings and latency costs, we set <span class="arithmatex">\(n=2\)</span>. We partition the code into a coarse subtoken <span class="arithmatex">\(b_t^c\)</span> and a fine subtoken <span class="arithmatex">\(b_t^f\)</span> of equal bit length. The resulting code <span class="arithmatex">\(b_t\)</span> is a concatenation of these two subtokens: <span class="arithmatex">\(b_t=[b_t^c,b_t^f]\)</span>.</p> <p>We train the tokenizer with a composite objective that combines a hierachical reconstruction loss and a commitment loss for BSQ:</p> <div class="arithmatex">\[ \mathcal{L}_{\text{tokenizer}} = \mathcal{L}_{\text{coarse}} + \mathcal{L}_{\text{fine}} + \lambda \mathcal{L}_{\text{quant}} \]</div> <p>where <span class="arithmatex">\(\lambda\)</span> is a balancing hyperparameter. The components are defined as:</p> <ul> <li><span class="arithmatex">\(\mathcal{L}_{\text{coarse}}=\mathbb{E}[\|\textbf{x}-E_{\text{dec}}(\textbf{b}^c)\|^2]\)</span>, which trains the coarse subtoken <span class="arithmatex">\(\textbf{b}^c\)</span> to form a low-fidelity reconstruction.</li> <li><span class="arithmatex">\(\mathcal{L}_{\text{fine}}=\mathbb{E}[\|\textbf{x}-E_{\text{dec}}(\textbf{b})\|^2]\)</span>, which evaluates the high-fidelity reconstruction using the complete token <span class="arithmatex">\(\textbf{b}\)</span>.</li> <li><span class="arithmatex">\(\mathcal{L}_{\text{quant}}\)</span> is the quantization loss from BSQ that regularizes the learning process. It penalizes the L2 distance between continuous latent vector <span class="arithmatex">\(\xi\)</span> and their binary codes <span class="arithmatex">\(\textbf{b}\)</span>, aligning the encoder's outputs with the learned codebook to ensure stable training.</li> </ul> <h3 id="42-hierarchical-autoregressive-modeling">4.2 Hierarchical Autoregressive Modeling<a class="headerlink" href="#42-hierarchical-autoregressive-modeling" title="Permanent link">¶</a></h3> <figure> <a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="figures/pretraining.png"><img _="," alt="pretrain" loading="lazy" src="figures/pretraining.png" width="70%"/></a> </figure> <p>The primary objective is to estimate the joint distribution over the token sequence <span class="arithmatex">\(\textbf{b}=\{b_1,...,b_r\}\)</span>. A simplified form of Equation 1 can be derived as:</p> <div class="arithmatex">\[ p(\textbf{b}) = \sum_{t=1}^Tp(b_t|\textbf{b}_{&lt;t}) \]</div> <p>where <span class="arithmatex">\(\textbf{b}_{&lt;t}\)</span> denotes all preceding tokens up to time <span class="arithmatex">\(t-1\)</span>.</p> <p>Given the hierarchical token design, in which each token is structured as <span class="arithmatex">\(b_t=[b_t^c,b_t^f]\)</span>, we further decompose the conditional probability using the chain rule to explicitly capture the inherent coarse-to-fine dependency:</p> <div class="arithmatex">\[ p(b_t|\textbf{b}_{&lt;t})=p(b_t^c|\textbf{b}_{&lt;t}) \cdot p(b_t^f|\textbf{b}_{&lt;t}, b_t^c) \]</div> <p>At time <span class="arithmatex">\(i\)</span>, the subtokens <span class="arithmatex">\(b_i^c\)</span> and <span class="arithmatex">\(b_i^f\)</span> are independently projected into vector representations using two <strong>distinct</strong> embedding layers, resulting in representations <span class="arithmatex">\(e_c(b_i^c)\)</span> and <span class="arithmatex">\(e_f(b_i^f)\)</span>, respectively. These embeddings are then concatenated and linearly projected to produce a fused input vector:</p> <div class="arithmatex">\[ \text{v}_i = W_{fuse}([e_c(b_i^c); e_f(b_i^f)]) \]</div> <p>where <span class="arithmatex">\([\cdot ; \cdot]\)</span> denotes concatenation, and <span class="arithmatex">\(W_{fuse}\)</span> is a learnable weight matrix responsible for projecting the combined representaion into the model's latent space.</p> <h4 id="coarse-subtoken-prediction">Coarse Subtoken Prediction<a class="headerlink" href="#coarse-subtoken-prediction" title="Permanent link">¶</a></h4> <p>The history vector <span class="arithmatex">\(\textbf{h}_t\)</span> is projected by a linear head <span class="arithmatex">\(W_c\)</span> to produce logits for the first subtoken's distribution:</p> <div class="arithmatex">\[ p(b_t^c|\textbf{b}_{&lt;c})=\text{softmax}(W_c\textbf{h}_t) \]</div> <h4 id="fine-subtoken-prediction">Fine Subtoken Prediction<a class="headerlink" href="#fine-subtoken-prediction" title="Permanent link">¶</a></h4> <p>During the trainiing, we use the model's own prediction from the previous step, <span class="arithmatex">\(\hat{b}_t^c\)</span>, which is sampled from the predicted distribution <span class="arithmatex">\(p(b_t^c|\textbf{b}_{&lt;t})\)</span>, rather than using the ground-truth subtoken(i.e., teacher-forcing). We use a cross-attention mechanism where the embedding of <span class="arithmatex">\(\hat{b}_t^c\)</span> acts as the query, and the history <span class="arithmatex">\(\textbf{h}_t\)</span> provides the key and value. The result is projected by the second head <span class="arithmatex">\(W_f\)</span>:</p> <div class="arithmatex">\[ \textbf{h}_t^{\text{update}} = \text{CrossAttn}(q=e_c(\hat{b}_t^c), k=v=\textbf{h}_t) \]</div> <div class="arithmatex">\[ p(b_t^f|\textbf{b}_{&lt;t},b_t^c)=\text{softmax}(W_f\textbf{h}_t^{\text{update}}) \]</div> <p>The overall training objective <span class="arithmatex">\(\mathcal{L}_{ar}\)</span> is the negative log-likelihood of the data, summed over both prediction steps:</p> <div class="arithmatex">\[ \mathcal{L}_{\text{ar}}=-\mathbb{E}_{\textbf{b}\sim\mathcal{D}} \sum_{t=1}^T\left[\log p(b_t^c|\textbf{b}_{&lt;t})+\log p(b_t^f|\textbf{b}_{&lt;t}, b_t^c)\right] \]</div> <p>where <span class="arithmatex">\(\mathcal{D}\)</span> represents the data distribution.</p> <h2 id="5-results-and-conclusion">5. Results and Conclusion<a class="headerlink" href="#5-results-and-conclusion" title="Permanent link">¶</a></h2> <p><figure markdown="span"> <a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="80%" href="figures/result.png"><img _="," alt="result" loading="lazy" src="figures/result.png" width="100%"/></a> </figure></p> <aside class="md-source-file"> <span class="md-source-file__fact"> <span class="md-icon" title="Last update"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2025年9月8日 10:48:45 CST"><span>2025<span class="heti-spacing"> </span></span>年<span class="heti-skip"><span class="heti-spacing"> </span>9<span class="heti-spacing"> </span></span>月<span class="heti-skip"><span class="heti-spacing"> </span>8<span class="heti-spacing"> </span></span>日<span><span class="heti-spacing"> </span>10:48:45</span></span> </span> <span class="md-source-file__fact"> <span class="md-icon" title="Created"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2025年9月8日 10:48:45 CST"><span>2025<span class="heti-spacing"> </span></span>年<span class="heti-skip"><span class="heti-spacing"> </span>9<span class="heti-spacing"> </span></span>月<span class="heti-skip"><span class="heti-spacing"> </span>8<span class="heti-spacing"> </span></span>日<span><span class="heti-spacing"> </span>10:48:45</span></span> </span> </aside> <!-- copy from https://squidfunk.github.io/mkdocs-material/setup/adding-a-comment-system/ --> <h2 id="__comments">Comments</h2> <!-- Insert generated snippet here --> <script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOO_yRsM4Cr6Uc" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="pathname" data-reactions-enabled="1" data-repo="BottleFish326/notes" data-repo-id="R_kgDOO_yRsA" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js">
</script> <!-- Synchronize Giscus theme with palette --> <script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate"
        ? "transparent_dark"
        : "light"

      // Instruct Giscus to set theme
      giscus.setAttribute("data-theme", theme) 
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate"
            ? "transparent_dark"
            : "light"

          // Instruct Giscus to change theme
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button class="md-top md-icon" data-md-component="top" hidden="" type="button"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class="md-footer"> <nav aria-label="Footer" class="md-footer__inner md-grid"> <a aria-label="Previous: Index" class="md-footer__link md-footer__link--prev" href="../"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </div> <div class="md-footer__title"> <span class="md-footer__direction"> Previous </span> <div class="md-ellipsis"> Index </div> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> <div class="md-social"> <a class="md-social__link" href="mailto:zpyu@zju.edu.cn" rel="noopener" target="_blank" title=""> <svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M536.4-26.3c9.8-3.5 20.6-1 28 6.3s9.8 18.2 6.3 28l-178 496.9c-5 13.9-18.1 23.1-32.8 23.1-14.2 0-27-8.6-32.3-21.7l-64.2-158c-4.5-11-2.5-23.6 5.2-32.6l94.5-112.4c5.1-6.1 4.7-15-.9-20.6s-14.6-6-20.6-.9l-112.4 94.3c-9.1 7.6-21.6 9.6-32.6 5.2L38.1 216.8c-13.1-5.3-21.7-18.1-21.7-32.3 0-14.7 9.2-27.8 23.1-32.8z" fill="currentColor"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <div class="md-progress" data-md-component="progress" role="progressbar"></div> <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.path", "navigation.prune", "navigation.indexes", "toc.follow", "navigation.top", "content.code.copy", "content.code.select", "content.tabs.link", "search.suggest", "search.highlight", "search.share", "header.autohide", "navigation.footer", "content.footnote.tooltips"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src="../../../assets/javascripts/bundle.92b07e13.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script> <script src="../../../javascripts/katex-render.js"></script> <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script> <script src="../../../javascripts/tablesort.js"></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>